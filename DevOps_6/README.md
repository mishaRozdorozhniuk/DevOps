# DevOps 6 ‚Äî –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSH, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ Bash-–≥—Ä–∞

---

## Bash-–≥—Ä–∞: ¬´–í–≥–∞–¥–∞–π —á–∏—Å–ª–æ¬ª

–°—Ü–µ–Ω–∞—Ä—ñ–π –≥–µ–Ω–µ—Ä—É—î –≤–∏–ø–∞–¥–∫–æ–≤–µ —á–∏—Å–ª–æ –≤—ñ–¥ 1 –¥–æ 100 —ñ –∑–±–µ—Ä—ñ–≥–∞—î –π–æ–≥–æ —É –∑–º—ñ–Ω–Ω—ñ–π. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –≤–≥–∞–¥–∞—Ç–∏ —á–∏—Å–ª–æ:

üìÑ **–§–∞–π–ª —Å—Ü–µ–Ω–∞—Ä—ñ—é:** `gues_number.sh`

![–°–∫—Ä—ñ–Ω—à–æ—Ç Bash-–≥—Ä–∏](gues_number.png)

---

## üë§ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `john`

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á `john` —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—é –¥–æ–º–∞—à–Ω—å–æ—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é.

![–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞](create-user-john.png)

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSH-—Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ—Ä—Ç 2222)

–ù–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω–∏–π SSH-—Å–µ—Ä–≤–µ—Ä –∑ —Ç–∞–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

- **–ø–æ—Ä—Ç:** 2222
- **–¥–æ—Å—Ç—É–ø root:** ‚ùå (–∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ)
- **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –ø–∞—Ä–æ–ª–µ–º:** ‚ùå (–∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ)
- **—Ç—ñ–ª—å–∫–∏ john –ø–æ ssh-–∫–ª—é—á—É:** ‚úÖ (–¥–æ–∑–≤–æ–ª–µ–Ω–æ)

![–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è sshd_config –¥–ª—è –ø–æ—Ä—Ç—É 2222](set_up_all_permissions.png)

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—É 2222

–ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤—ñ—Å—É SSH, –±—É–ª–æ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ, —â–æ —Å–µ—Ä–≤–µ—Ä –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É—î –ø–æ—Ä—Ç 2222 .

![–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–º—ñ–Ω–∏ –ø–æ—Ä—Ç—É —Ç–∞ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è](change-port-2222.png)

---

## üîë –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è SSH-–∫–ª—é—á–∞ –¥–ª—è `john`

–Ø —Å—Ç–≤–æ—Ä—é—é –ø–∞—Ä—É –∫–ª—é—á—ñ–≤ –Ω–∞ –º–æ—î–º—É mac. –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ø–æ—Ç—ñ–º –∫–æ–ø—ñ—é—î—Ç—å—Å—è –≤ `~/.ssh/authorized_keys` —è–∫–∏–π —è —Å—Ç–≤–æ—Ä—é –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `john` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.

![–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞](gen-ssh-keygen-john.png)

–ó–∞—Ö–æ–¥–∏–º–æ —è–∫ john —Ç–∞ —Å–≤–æ—Ä—é—î–º—É –¥–ª—è –Ω—å–æ–≥–æ authorized_keys —Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –ø–µ—Ä–º—ñ—à–µ–Ω–∏

![–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—É –≤—Ö–æ–¥—É –ª–∏—à–µ –¥–ª—è john](set_ssh_for_jogn.png)

–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ

![–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∫–ª—é—á–∞ —É authorized_keys](check-ssh-key-for-john.png)

---

## üß™ –£—Å–ø—ñ—à–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ SSH-—Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ—Ä—Ç 2222)

–ü—ñ—Å–ª—è –≤—Å—ñ—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å –¥–æ–∑–≤–æ–ª—ñ–≤, –±—É–ª–æ –∑–¥—ñ–π—Å–Ω–µ–Ω–æ —É—Å–ø—ñ—à–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ SSH-—Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ—Ä—Ç 2222) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SSH-–∫–ª—é—á–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `john`.

![–£—Å–ø—ñ—à–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ SSH –∫–ª—é—á—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º john](login-with-ssh-as-john.png)

*–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–µ—Å—ñ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, –≤–∫–ª—é—á–∞—é—á–∏ —Å–µ—Å—ñ—é `john`:*

---
## üîê –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π –≤—Ö—ñ–¥ `root` —Ç–∞ –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–ª—è —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSH-—Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ—Ä—Ç 2222) –∑–∞–±–æ—Ä–æ–Ω—è—é—Ç—å –≤—Ö—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É `root` —Ç–∞ –æ–±–º–µ–∂—É—é—Ç—å –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –¥–ª—è `john` (—á–µ—Ä–µ–∑ `AllowUsers john`).

![–ü–æ–º–∏–ª–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–ª—è root/—ñ–Ω—à–∏—Ö](permission-denied.png)

---

## –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫ SSH —É debug-—Ä–µ–∂–∏–º—ñ –Ω–∞ –ø–æ—Ä—Ç—É 3333

–î–ª—è –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –±—É–ª–æ –∑–∞–ø—É—â–µ–Ω–æ –¥—Ä—É–≥–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä SSH-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç—É 3333. –¶–µ–π —Å–µ—Ä–≤–µ—Ä –º–∞—î —ñ–Ω—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:

–°–ø–æ—á–∞—Ç–∫—É —Å–∫–æ–ø—ñ—é—î–º–æ —ñ—Å–Ω—É—é—á–∏–π –∫–æ–Ω—Ñ—ñ–≥ —â–æ–± –Ω–µ –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∞–∫—Ç—É–∞–ª—å–Ω–∏–π

![–ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ –≤ authorized_keys](first-create-copy.png)


- –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –≤—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (–∫—Ä—ñ–º root)
- –¥–æ–∑–≤–æ–ª–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —è–∫ –ø–æ –ø–∞—Ä–æ–ª—é, —Ç–∞–∫ —ñ –ø–æ –∫–ª—é—á—É

![SSH debug 3333](3333-ssh.png)

- –∑–∞–ø—É—â–µ–Ω–æ –≤ debug-—Ä–µ–∂–∏–º—ñ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è

![–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –æ–±–æ—Ö SSH-—Å–µ—Ä–≤–µ—Ä—ñ–≤](ssh-3333-result.png)

---

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±–æ—Ö SSH-—Å–µ—Ä–≤–µ—Ä—ñ–≤


![–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –æ–±–æ—Ö SSH-—Å–µ—Ä–≤–µ—Ä—ñ–≤](all-users.png)

---

